@model IMBD.ViewModel.AddMovieViewModel
@using IMBD.Models
@{

    ViewBag.Title = "Add";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Modify Movie</h2>


<script src="~/Scripts/jquery-1.12.4.js"></script>






@using (Html.BeginForm("Edit", "movies", FormMethod.Post, new { role = "form", enctype = "multipart/form-data" }))
{
    <div class="form-group">
        <label>Name:</label>
        @Html.TextBoxFor(m => m.Name, new
        {
            @class = "form-control",
            oninput = "setCustomValidity('')",
            name = "Movie Name",
            required = true,
            oninvalid = "this.setCustomValidity('Please Enter a name for the movie')",
            Value = Model.SelectedMovie.Name
        })

    </div>
    <div class="form-group">
        <label>Plot:</label>
        @Html.TextAreaFor(m => m.Plot, new
        {
            @class = "form-control",
            required = "required",
            oninput = "setCustomValidity('')",
            oninvalid = "this.setCustomValidity('Please Enter a Plot for the movie')",
            Value = Model.Plot
        })
    </div>

    <div class="form-group">
        <label>Release Date:</label>
        <br />

        @Html.TextBoxFor(m => m.ReleaseDate, new
   {
       @class = "form-control",
       id="Rd",
       type = "date",
       Value=Model.FormattedDate
   })


    </div>


    <div class="form-group">
        <label for="Producers">Add Producers:</label>
        <br />
        <div id="plist">
            @Html.DropDownListFor(m => m.ProducerId, new SelectList(Model.Producers, "Id", "Name"), "Select Producers", new { @class = "form-control", id = "Producerdd" })
            
        
        </div>
        <div class="col-md-1" id="prodiv">
            <button id="btnAddProducer" type="button"
                    class="btn btn-primary" data-target="#ProducerModal" data-toggle="modal">
                Add Producer
            </button>
        </div>
    </div>


    <div class="form-group" id="actfg">
        <div id="ac">

            <label id="acl">Add Actors:</label>
            <br />

         @*   @Html.ListBoxFor(m => m.ActorIds, new MultiSelectList(Model.Actors, "Id", "Name"), new { @class = "form-control", id = "Actordd", Multiple = "multiple", style = "width=200" })*@
            <select class="actor_dropdown" id="Actordd" multiple="multiple" name="ActorIds">

                @{
        foreach (var actor in Model.Actors)
        {



            if (Model != null && Model.SelectedActors.Contains(actor))
            {
                <option value=@actor.Id selected>@actor.Name</option>

}
else
{
            <option value=@actor.Id>@actor.Name</option>
}
}
                }
            </select>
</div>
        <div class="col-md-1" id="actdiv">
            <button id="btnAddActor" type="button"
                    class="btn btn-primary" data-target="#ActorModal" data-toggle="modal">
                Add Actor
            </button>
        </div>
    </div>

    <div class="form-group">
        <label id="acl">Movie poster:</label>
        @{
            string image = "~/Content/Posters/" + Model.SelectedMovie.Id + ".jpg";
        }
        @Html.TextBoxFor(m => m.File, new { @class = "form-control", type = "file" })
    </div>

    <div class="row">



    </div>


    <div class="row">
        <div class="col-md-1" id="am">
            <button type="submit" id="AddMovie" class="btn btn-primary">Save</button>
        </div>
    </div>

    

    @*<script src="~/Scripts/chosen.jquery.js"></script>*@
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.full.js"></script>

    <script type="text/javascript">
       
    </script>


    @*<link href="~/Content/chosen.css" rel="stylesheet" />*@
}


@*<script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script>*@

<div class="modal fade" tabindex="-1" id="ActorModal"
     data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    ×
                </button>
                <h4 class="modal-title">Add new Actor</h4>
            </div>
            <div class="modal-body">

                @Html.Partial("ActorForm")

            </div>

        </div>
    </div>
</div>








@*This is the pop up for Producers*@




<div class="modal fade" tabindex="-2" id="ProducerModal"
     data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    ×
                </button>
                <h4 class="modal-title">Add new Producer</h4>
            </div>
            <div class="modal-body">
                @*<script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script>*@
                @Html.Partial("ProducerForm")

            </div>

        </div>
    </div>
</div>

<link href="~/Content/IMDB_Styles/modifyMovie.css" rel="stylesheet" />

<script src="~/Scripts/IMBD_scripts/modifyMovie.js"></script>
<script type="text/javascript">
        $(document).ready(function () {
            $('#Producerdd').val(@Model.SelectedProducer.Id);
            $('#Producerdd').trigger('change');
            $('#select2-Producerdd-container').text('@Model.SelectedProducer.Name');
          
        });
</script>

